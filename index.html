<!DOCTYPE html>
<!-- Versão 2.0.0 - Migrado para Arquitetura Modular -->
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8B0000">
    <meta name="description" content="Calculadora para volume e custo de madeira serrada - Sistema de Login">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="CalcMadeira">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <title>Calculadora de Madeira - Login</title>
    
    <!-- CSS MODULAR - Nova Arquitetura -->
    <link rel="stylesheet" href="css/main.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="auth-page">
    <!-- HEADER da página de autenticação -->
    <header class="auth-header">
        <img src="logo.png" alt="Logo da Calculadora de Madeira" class="auth-logo">
        <h1>Calculadora de Madeira</h1>
        <p>Faça login ou crie uma conta para começar a calcular volumes e custos de madeira</p>
    </header>

    <!-- CONTAINER PRINCIPAL DE AUTENTICAÇÃO -->
    <main class="auth-container">
        <div class="auth-form-container">
            
            <!-- FORMULÁRIO DE LOGIN -->
            <div id="loginForm">
                <h2 class="auth-form-title">
                    <i class="fas fa-sign-in-alt"></i> Entrar na Conta
                </h2>
                
                <div class="auth-message auth-error-message" id="loginError"></div>
                <div class="auth-message auth-success-message" id="loginSuccess"></div>
                
                <div class="auth-form-group">
                    <label for="loginEmail">
                        <i class="fas fa-envelope"></i> Email
                    </label>
                    <input type="email" 
                           id="loginEmail" 
                           inputmode="email" 
                           autocomplete="email"
                           placeholder="seu@email.com"
                           required>
                </div>
                
                <div class="auth-form-group">
                    <label for="loginPassword">
                        <i class="fas fa-lock"></i> Senha
                    </label>
                    <input type="password" 
                           id="loginPassword" 
                           inputmode="text"
                           autocomplete="current-password"
                           placeholder="Sua senha"
                           required>
                </div>
                
                <button class="auth-btn" id="loginButton" onclick="login()">
                    <i class="fas fa-sign-in-alt"></i> Entrar
                </button>
                
                <div class="auth-toggle">
                    <a href="#" onclick="toggleForms()">
                        <i class="fas fa-user-plus"></i> Não tem uma conta? Registre-se
                    </a>
                    <br>
                    <a href="#" onclick="showResetPassword()" style="margin-top: 10px; display: inline-block;">
                        <i class="fas fa-key"></i> Esqueci minha senha
                    </a>
                </div>
            </div>

            <!-- FORMULÁRIO DE RECUPERAÇÃO DE SENHA -->
            <div id="resetPasswordForm" style="display: none;">
                <h2 class="auth-form-title">
                    <i class="fas fa-key"></i> Recuperar Senha
                </h2>
                
                <div class="auth-message auth-error-message" id="resetError"></div>
                <div class="auth-message auth-success-message" id="resetSuccess"></div>
                
                <div class="auth-form-group">
                    <label for="resetEmail">
                        <i class="fas fa-envelope"></i> Email
                    </label>
                    <input type="email" 
                           id="resetEmail" 
                           inputmode="email"
                           autocomplete="email"
                           placeholder="seu@email.com"
                           required>
                </div>
                
                <div id="resetCodeSection" class="auth-code-section" style="display: none;">
                    <div class="auth-form-group">
                        <label for="resetCode">
                            <i class="fas fa-shield-alt"></i> Código de Verificação
                        </label>
                        <input type="text" 
                               id="resetCode" 
                               inputmode="numeric"
                               pattern="[0-9]*"
                               maxlength="6"
                               placeholder="000000"
                               required>
                    </div>
                    
                    <div class="auth-form-group">
                        <label for="newPassword">
                            <i class="fas fa-lock"></i> Nova Senha
                        </label>
                        <input type="password" 
                               id="newPassword" 
                               inputmode="text"
                               autocomplete="new-password"
                               placeholder="Nova senha (mín. 6 caracteres)"
                               required>
                    </div>
                    
                    <div class="auth-form-group">
                        <label for="confirmNewPassword">
                            <i class="fas fa-lock"></i> Confirmar Nova Senha
                        </label>
                        <input type="password" 
                               id="confirmNewPassword"
                               placeholder="Confirme a nova senha" 
                               required>
                    </div>
                </div>
                
                <button class="auth-btn" id="resetButton" onclick="requestPasswordReset()">
                    <i class="fas fa-paper-plane"></i> Enviar Código
                </button>
                
                <div class="auth-toggle">
                    <a href="#" onclick="showLogin()">
                        <i class="fas fa-arrow-left"></i> Voltar ao Login
                    </a>
                </div>
            </div>

            <!-- FORMULÁRIO DE REGISTRO -->
            <div id="registerForm" style="display: none;">
                <h2 class="auth-form-title">
                    <i class="fas fa-user-plus"></i> Criar Conta
                </h2>
                
                <div class="auth-message auth-error-message" id="registerError"></div>
                
                <div class="auth-form-group">
                    <label for="registerName">
                        <i class="fas fa-user"></i> Nome Completo
                    </label>
                    <input type="text" 
                           id="registerName" 
                           inputmode="text"
                           autocomplete="name"
                           placeholder="Seu nome completo"
                           required>
                </div>
                
                <div class="auth-form-group">
                    <label for="registerEmail">
                        <i class="fas fa-envelope"></i> Email
                    </label>
                    <input type="email" 
                           id="registerEmail" 
                           inputmode="email"
                           autocomplete="email"
                           placeholder="seu@email.com"
                           required>
                </div>
                
                <div class="auth-form-group">
                    <label for="registerPassword">
                        <i class="fas fa-lock"></i> Senha
                    </label>
                    <input type="password" 
                           id="registerPassword" 
                           inputmode="text"
                           autocomplete="new-password"
                           placeholder="Senha (mín. 6 caracteres)"
                           required>
                </div>
                
                <div class="auth-form-group">
                    <label for="confirmPassword">
                        <i class="fas fa-lock"></i> Confirmar Senha
                    </label>
                    <input type="password" 
                           id="confirmPassword" 
                           inputmode="text"
                           autocomplete="new-password"
                           placeholder="Confirme sua senha"
                           required>
                </div>
                
                <button class="auth-btn" id="registerButton" onclick="register()">
                    <i class="fas fa-user-plus"></i> Criar Conta
                </button>
                
                <div class="auth-toggle">
                    <a href="#" onclick="toggleForms()">
                        <i class="fas fa-sign-in-alt"></i> Já tem uma conta? Faça login
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- SISTEMA DE FEEDBACK (será controlado pelo módulo feedback.js) -->
    <div id="feedbackContainer" class="feedback-container"></div>

    <!-- JavaScript Modular - Nova Arquitetura -->
    <script type="module">
        // Import da aplicação principal
        import { initializeApp } from './js/core/app.js';
        
        // Import específico da página de autenticação
        import './js/pages/auth.js';
        
        // Event listener para confirmação de carregamento
        document.addEventListener('calculadoraMadeiraReady', (event) => {
            console.log('🎉 Página de Login Carregada!', event.detail);
            
            // A aplicação e os módulos específicos da página já foram inicializados
            // Toda a funcionalidade de autenticação está disponível
        });
    </script>
    
    <!-- Fallback para navegadores sem suporte a módulos ES6 -->
    <script nomodule>
        alert('Seu navegador não suporta módulos ES6. Por favor, use um navegador mais recente (Chrome 61+, Firefox 60+, Safari 10.1+, Edge 16+).');
    </script>

    <!-- Scripts de Compatibilidade - Mantidos para funcionalidade de auth -->
    <script src="auth.js"></script>
    
    <!-- PWA Scripts -->
    <script src="pwa-updater.js"></script>
    <script src="update-checker.js"></script>
</body>
</html> 